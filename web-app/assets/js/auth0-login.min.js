document.getElementById("branson").onclick=function(){showGoogle()};document.getElementById("ma").onclick=function(){showGoogle()};document.getElementById("headlands").onclick=function(){showPassword()};document.getElementById("tilden").onclick=function(){showPassword()};document.getElementById("branson-summer").onclick=function(){showPassword()};document.getElementById("ngs").onclick=function(){showPassword()};var newAuth=false;window.onload=async()=>{$("#branson").addClass("disabled");$("#branson").html(`Loading...`);$("#ma").addClass("disabled");$("#ma").html(`Loading...`);$("#headlands").addClass("disabled");$("#headlands").html(`Loading...`);$("#tilden").addClass("disabled");$("#tilden").html(`Loading...`);$("#branson-summer").addClass("disabled");$("#branson-summer").html(`Loading...`);$("#ngs").addClass("disabled");$("#ngs").html(`Loading...`);await configureClient();const isAuthenticated=await auth0.isAuthenticated();$("#branson").removeClass("disabled");$("#branson").html("School year login");$("#ma").removeClass("disabled");$("#ma").html("Login with ma.org");$("#headlands").removeClass("disabled");$("#headlands").html("Login with password");$("#tilden").removeClass("disabled");$("#tilden").html("Login with password");$("#branson-summer").removeClass("disabled");$("#branson-summer").html("Summer login");$("#ngs").removeClass("disabled");$("#ngs").html("Login with email");const onSecondAuthAttempt=(localStorage.getItem("timesAttemptedToMark")||0)>0;if(isAuthenticated&&!onSecondAuthAttempt){document.location.href="/home.html";return}var urlParams;(window.onpopstate=function(){var match,pl=/\+/g,search=/([^&=]+)=?([^&]*)/g,decode=function(s){return decodeURIComponent(s.replace(pl," "))},query=window.location.search.substring(1);urlParams={};while(match=search.exec(query))urlParams[decode(match[1])]=decode(match[2])})();if("code"in urlParams&&"state"in urlParams){$("#branson").addClass("disabled");$("#branson").html(`ðŸ” Encrypting...`);$("#ma").addClass("disabled");$("#ma").html(`ðŸ” Encrypting...`);$("#headlands").addClass("disabled");$("#headlands").html(`ðŸ” Encrypting...`);$("#tilden").addClass("disabled");$("#tilden").html(`ðŸ” Encrypting...`);$("#branson-summer").addClass("disabled");$("#branson-summer").html(`ðŸ” Encrypting...`);$("#ngs").addClass("disabled");$("#ngs").html(`ðŸ” Encrypting...`);await auth0.handleRedirectCallback();const claims=await auth0.getIdTokenClaims();authToken=claims.__raw;var timesTried=localStorage.getItem("timesAttemptedToMark");if(timesTried===null){localStorage.setItem("timesAttemptedToMark",0)}else if(timesTried>0){$("#branson").html(`ðŸ” Setting up your account...`);$("#ma").html(`ðŸ” Setting up your account...`);$("#headlands").html(`ðŸ” Setting up your account...`);$("#tilden").html(`ðŸ” Setting up your account...`);$("#branson-summer").html(`ðŸ” Setting up your account...`);$("#ngs").html(`ðŸ” Setting up your account...`)}markUserAsActive().then(function(){loginFinished();localStorage.removeItem("timesAttemptedToMark")}).catch(async function(){if(localStorage.getItem("timesAttemptedToMark")>1){alert("Couldn't mark you as an active user. Make sure you're connected to internet and log out and log in again. If the error persists please contact us.");localStorage.removeItem("timesAttemptedToMark");window.location=window.location.pathname}else{localStorage.setItem("timesAttemptedToMark",timesTried+1);unspecifiedLogin()}})}else if("error"in urlParams&&"error_description"in urlParams){alert(urlParams["error"]+" â€“ "+urlParams["error_description"])}};function loginFinished(){$(document).ready(function(){$("#branson").removeClass("disabled");$("#branson").html("School year login");$("#ma").removeClass("disabled");$("#ma").html("Login with ma.org");$("#headlands").removeClass("disabled");$("#headlands").html("Login with password");$("#tilden").removeClass("disabled");$("#tilden").html("Login with password");$("#branson-summer").removeClass("disabled");$("#branson-summer").html("Summer login");$("#ngs").removeClass("disabled");$("#ngs").html("Login with email")});document.location.href="/home.html"}const showGoogle=async()=>{await auth0.loginWithRedirect({redirect_uri:window.location.origin,connection:"google-oauth2"})};const showPassword=async()=>{await auth0.loginWithRedirect({redirect_uri:window.location.origin,connection:"MT-Email-Pass"})};const unspecifiedLogin=async()=>{await auth0.loginWithRedirect({redirect_uri:window.location.origin})};